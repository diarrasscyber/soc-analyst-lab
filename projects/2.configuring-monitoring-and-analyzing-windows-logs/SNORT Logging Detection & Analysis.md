# üõ°Ô∏è SNORT Logging, Detection & Analysis Lab  
## Configure, Detect, and Analyze Network Attacks Using Snort

This lab will teach you how to:

- Install and configure Snort  
- Detect ICMP, FTP, Web, and SQL Injection attacks  
- Analyze logs generated by Snort  
- Perform attacks from Kali Linux to validate detection

Lab environment:

- **Windows Server 2019**
- **Kali Linux (attacker)**
- **Ubuntu Linux (Snort sensor)**

---

# 1Ô∏è‚É£ Configure Ubuntu Machine (Snort Sensor)

### Network Configuration (Ubuntu)
- **IP Address:** 192.168.103.100
- **Mask:** 255.255.255.0
- **Gateway:** 192.168.103.1
- **DNS:** 8.8.8.8

---

# 2Ô∏è‚É£ Install Snort on Ubuntu

Run the following commands:

sudo apt update && sudo apt upgrade -y
sudo apt install snort -y
During installation, enter the monitored network:192.168.103.0/24

# 3Ô∏è‚É£ Test Connectivity

Ping the other machines to confirm network communication.

---

# 4Ô∏è‚É£ Snort Configuration

-Go to the Snort directory:
cd /etc/snort
ls
-Backup the configuration file:sudo cp snort.conf /etc/snort/snort_backup.conf
-Open Snort configuration file: sudo nano /etc/snort/snort.conf
-Enable line numbering in Nano:
ALT + N
Edit line 65
Replace: any With:192.168.103.0/24
Save and exit.
-Validate Snort Configuration: sudo snort -T -c /etc/snort/snort.conf
-Start Snort in Alert Mode: sudo snort -A console -q -c /etc/snort/snort.conf -i ens33
-Perform Network Scan Attack from Kali:nmap 192.168.103.200
-Snort should display alerts reacting to the scan

---

# 5Ô∏è‚É£ Add Detection Rules in Snort

Navigate to the rules directory:cd /etc/snort/rules
Edit the local.rules file:sudo nano /etc/snort/rules/local.rules
**Add the following detection rules:**
# ICMP attempt on Windows Server 2019
alert icmp any any -> 192.168.103.19 any (msg:"ICMP connection attempt"; itype:8; sid:100001; rev:1;)

# ICMP attempt on SIEM1 (Windows Server 2022)
alert icmp any any -> 192.168.103.22 any (msg:"ICMP connection attempt"; itype:8; sid:100002; rev:1;)

# ICMP attempt on SIEM2 (Windows 10)
alert icmp any any -> 192.168.103.18 any (msg:"ICMP connection attempt"; itype:8; sid:100003; rev:1;)

# FTP connection attempt on Windows Server 2019
alert icmp any any -> 192.168.103.19 21 (msg:"FTP connection attempt"; itype:8; sid:100004; rev:1;)

# Web connection attempt on Windows Server 2019
alert icmp any any -> 192.168.103.19 80 (msg:"WEB connection attempt"; itype:8; sid:100005; rev:1;)

# ICMP attempt on Snort Server
alert icmp any any -> 192.168.103.200 any (msg:"ICMP connection attempt"; itype:8; sid:100006; rev:1;)

Validate Configuration Again:sudo snort -T -c /etc/snort/snort.conf
Restart Snort in alert mode:sudo snort -A console -q -c /etc/snort/snort.conf -i ens33

---

# 6Ô∏è‚É£Detect SQL Injection Attack Using Snort

Since Snort already includes SQL Injection signatures, we will test detection with the LuxuryTreats website hosted on Windows Server 2019.

Configure hosts file on Kali:sudo nano /etc/hosts
Add:192.168.103.19 www.luxurytreats.com
    127.0.0.1 fonts.googleapis.com
Save and exit

**Perform SQL Injection from Kali**

-Open a web browser
-Visit: www.luxurytreats.com
    Log in: Username: bob
    Password: Passw0rd
(Credentials may also be brute-forced earlier in the lab)
Go to My Orders
Click ORD-001
In the address bar, inject:' OR 1=1;--
If vulnerable, this reveals all of Bob's orders, confirming the SQL Injection

# 7Ô∏è‚É£ Check Snort Alerts
Back on the Ubuntu Snort machine, you should now see Snort alerts detecting:

‚úîÔ∏è ICMP recon
‚úîÔ∏è Nmap scan
‚úîÔ∏è FTP/Web access attempts
‚úîÔ∏è SQL Injection attack
